!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("prop-types"),require("@pile/icon"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","prop-types","@pile/icon","react-dom"],t):t((e=e||self)["@pile/toast"]={},e.React,e.PropTypes,e.Icon,e.ReactDOM)}(this,function(e,o,t,r,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}t=t&&t.hasOwnProperty("default")?t.default:t,r=r&&r.hasOwnProperty("default")?r.default:r;var f=!!(n=n&&n.hasOwnProperty("default")?n.default:n).createPortal,h=function(e){function t(e){return i(this,t),p(this,u(t).call(this,e))}return s(t,o.Component),a(t,[{key:"componentDidMount",value:function(){this.props.visible&&this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){!f&&this.props.visible&&this.renderDialog(this.props.visible)}},{key:"componentWillUnmount",value:function(){this.props.visible?f?this.removeContainer():this.renderDialog(!1):this.removeContainer()}},{key:"getContainer",value:function(){if(!this.container){var e=document.createElement("div"),t="pile-container-".concat((new Date).getTime());e.setAttribute("id",t),document.body.appendChild(e),this.container=e}return this.container}},{key:"getComponent",value:function(){var e=this.props;return o.cloneElement(e.children,function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({onAnimateLeave:this.removeContainer.bind(this)},e))}},{key:"removeContainer",value:function(){if(this.container){f||n.unmountComponentAtNode(this.container),this.container.parentNode.removeChild(this.container),this.container=null;var e=this.props.onClose;e&&e()}}},{key:"renderDialog",value:function(){n.unstable_renderSubtreeIntoContainer(this,this.getComponent(),this.getContainer())}},{key:"render",value:function(){var e=this.props.visible;return f&&e?n.createPortal(this.getComponent(),this.getContainer()):null}}]),t}(),m=function(e){function t(){return i(this,t),p(this,u(t).apply(this,arguments))}return s(t,o.Component),a(t,[{key:"componentDidMount",value:function(){this.startCloseTimer()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.duration,o=t.content,r=t.iconType;n===e.duration&&o===e.content&&r===e.iconType||this.restartCloseTimer()}},{key:"componentWillUnmount",value:function(){this.clearCloseTimer()}},{key:"close",value:function(){this.clearCloseTimer()}},{key:"startCloseTimer",value:function(){var e=this,t=this.props.duration;t&&(this.closeTimer=setTimeout(function(){e.close()},1e3*t))}},{key:"clearCloseTimer",value:function(){this.closeTimer&&(clearTimeout(this.closeTimer),this.closeTimer=null)}},{key:"restartCloseTimer",value:function(){this.clearCloseTimer(),this.startCloseTimer()}},{key:"render",value:function(){var e=this.props,t=e.content,n=e.iconType;return o.createElement("div",{className:"pile-toast"},n?o.createElement(r,{type:"check-circle",size:"large"}):null,o.createElement("div",{className:"pile-toast-content"},t))}}]),t}(),d=function(e){return o.createElement(h,e,o.createElement(m,null))};d.propTypes={content:t.string,iconType:t.oneOf(["success","fail","load",""]),duration:t.number,visible:t.bool,onClose:t.func},d.defaultProps={content:"",iconType:"",duration:3,visible:!1,onClose:null},e.Toast=d,Object.defineProperty(e,"__esModule",{value:!0})});
